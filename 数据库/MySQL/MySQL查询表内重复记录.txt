MySQL查询表内重复记录(效率低)
 
(一)
1、查找表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断
select * from people
where peopleId in (select peopleId from people group by peopleId having count(peopleId) > 1)
 
2、删除表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断，只留有一个记录
delete from people
where peopleId in (select peopleId from people group by peopleId having count(peopleId) > 1)
and min(id) not in (select id from people group by peopleId having count(peopleId )>1)
 
3、查找表中多余的重复记录（多个字段）
最大的缺点：效率低下，如果数据量超过1万差不多就会死掉。
select * from order a
where (a.peopleId,a.seq) in (select peopleId,seq from order group by peopleId,seq having count(*) > 1)
 
4、删除表中多余的重复记录（多个字段），只留有rowid最小的记录
delete from order a
where (a.peopleId,a.seq) in (select peopleId,seq from order group by peopleId,seq having count(*) > 1)
and rowid not in (select min(rowid) from order group by peopleId,seq having count(*)>1)
 
5、查找表中多余的重复记录（多个字段），不包含rowid最小的记录
select * from order a
where (a.peopleId,a.seq) in (select peopleId,seq from order group by peopleId,seq having count(*) > 1)
and rowid not in (select min(rowid) from order group by peopleId,seq having count(*)>1)
 

(二)
比方说
在A表中存在一个字段“name”，
而且不同记录之间的“name”值有可能会相同，
现在就是需要查询出在该表中的各记录之间，“name”值存在重复的项；

Select Name,Count(*) From A Group By Name Having Count(*) > 1
 

 
如果还查性别也相同大则如下:

Select Name,sex,Count(*) From A Group By Name,sex Having Count(*) > 1
 

 
(三)
方法一

declare @max integer,@id integer
 
declare cur_rows cursor local for select 主字段,count(*) from 表名 group by 主字段 having count(*) >； 1
 
open cur_rows
 
fetch cur_rows into @id,@max
 
while @@fetch_status=0
 
begin
 
select @max = @max -1
 
set rowcount @max
 
delete from 表名 where 主字段 = @id
 
fetch cur_rows into @id,@max
 
end
 
close cur_rows
 
set rowcount 0
 